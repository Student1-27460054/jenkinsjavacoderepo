pipeline {
    agent any
    environment {
        GITHUB_REPO = 'https://github.com/Student1-27460054/jenkinsjavacoderepo.git'  // Replace with your repo URL
        GITHUB_CREDENTIALS = 'ccce5f9a-35bd-405f-bd41-2f7fd80d06ef'  // Jenkins credential ID for GitHub token
    }
    stages {
        stage('Checkout') {
            steps {
                // Clone the GitHub repository
                git credentialsId: "${GITHUB_CREDENTIALS}", url: "${GITHUB_REPO}"
            }
        }
        stage('Build') {
            steps {
                // Build the project using Maven (or any other build tool)
                sh 'mvn clean package'
            }
        }
        stage('Push Artifacts to GitHub') {
            steps {
                script {
                    // Assuming the artifacts are in the target folder and are .jar files
                    def artifactFiles = 'target/*.jar'  // Adjust path if needed

                    // Copy the artifacts to a location that will be committed to GitHub
                    sh 'mkdir -p pushed_artifacts'
                    sh "cp ${artifactFiles} pushed_artifacts/"

                    // Git configuration
                    sh 'git config user.name "Jenkins CI"'
                    sh 'git config user.email "jenkins@yourdomain.com"'

                    // Add and commit the changes
                    sh 'git add pushed_artifacts/*'
                    sh 'git commit -m "Add build artifacts" || echo "No changes to commit"'

                    // Push the changes to GitHub
                    sh 'git push origin main'  // Adjust branch if necessary
                }
            }
        }
    }
    post {
        always {
            // Optionally, clean up
            cleanWs()
        }
    }
}
